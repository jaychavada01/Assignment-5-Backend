# ğŸš€ ASSIGNMENT-5 BACKEND WORK

## ğŸ“Œ Project Overview

This project is a backend application built with **Node.js**, **Express.js**, and **Sequelize** (ORM for PostgreSQL). It includes user authentication, JWT-based authorization, a referral and rewards system, activity tracking, achievements, AWS integrations for S3 file storage and SQS messaging, and multilingual support.

---

## ğŸ“‚ Project Structure

```
Assignment/
â”œâ”€ .gitignore                              # Git ignore file
â”œâ”€ readme.MD                               # Project documentation
â”œâ”€ api/                                    # Main application directory
â”‚  â”œâ”€ .env                                 # Environment variables
â”‚  â”œâ”€ app.js                               # Application entry point
â”‚  â”œâ”€ package.json                         # Project dependencies
â”‚  â”œâ”€ package-lock.json                    # Dependency lock file
â”‚  â”‚
â”‚  â”œâ”€ config/                              # Configuration files
â”‚  â”‚  â”œâ”€ aws.js                            # AWS configuration
â”‚  â”‚  â”œâ”€ constant.js                       # Application constants
â”‚  â”‚  â”œâ”€ database.js                       # Database configuration
â”‚  â”‚  â”œâ”€ firebase.js                       # Firebase configuration
â”‚  â”‚  â”œâ”€ serviceAccountKey.json            # Firebase service account key
â”‚  â”‚  â”œâ”€ stripe.js                         # Stripe payment configuration
â”‚  â”‚  â””â”€ swagger.js                        # API documentation configuration
â”‚  â”‚
â”‚  â”œâ”€ controller/                          # Request handlers
â”‚  â”‚  â”œâ”€ authController.js                 # Authentication controllers
â”‚  â”‚  â”œâ”€ awsController.js                  # AWS-related controllers
â”‚  â”‚  â””â”€ stripeController.js               # Payment processing controllers
â”‚  â”‚
â”‚  â”œâ”€ helpers/                             # Helper functions
â”‚  â”‚  â””â”€ sqsworker.js                      # SQS message processing worker
â”‚  â”‚
â”‚  â”œâ”€ locales/                             # Multilingual support files
â”‚  â”‚  â”œâ”€ de.json                           # German translations
â”‚  â”‚  â”œâ”€ en.json                           # English translations
â”‚  â”‚  â”œâ”€ fr.json                           # French translations
â”‚  â”‚  â””â”€ hi.json                           # Hindi translations
â”‚  â”‚
â”‚  â”œâ”€ middleware/                          # Middleware functions
â”‚  â”‚  â”œâ”€ auth.js                           # Authentication middleware
â”‚  â”‚  â”œâ”€ i18n.js                           # Internationalization middleware
â”‚  â”‚  â””â”€ upload.js                         # File upload middleware
â”‚  â”‚
â”‚  â”œâ”€ models/                              # Database models
â”‚  â”‚  â”œâ”€ activity.js                       # User activity tracking model
â”‚  â”‚  â”œâ”€ cardDetails.js                    # Payment card details model
â”‚  â”‚  â”œâ”€ notificationToken.js              # User notification tokens model
â”‚  â”‚  â””â”€ user.js                           # User account model
â”‚  â”‚
â”‚  â”œâ”€ routes/                              # API routes
â”‚  â”‚  â”œâ”€ paymentRoute.js                   # Payment endpoint routes
â”‚  â”‚  â””â”€ userRoute.js                      # User endpoint routes
â”‚  â”‚
â”‚  â”œâ”€ uploads/                             # Temporary file storage
â”‚  â”‚  â”œâ”€ 1741156197174-images.jpeg         # Uploaded image example
â”‚  â”‚  â””â”€ 1741156262013-images.jpeg         # Uploaded image example
â”‚  â”‚
â”‚  â””â”€ utils/                               # Utility functions
â”‚     â”œâ”€ activityCalculator.js             # User activity calculation logic
â”‚     â”œâ”€ mailer.js                         # Email sending functionality
â”‚     â”œâ”€ notification.js                   # Push notification services
â”‚     â”œâ”€ s3.js                             # AWS S3 interaction utilities
â”‚     â””â”€ sqs.js                            # AWS SQS interaction utilities
```

---

## âš™ï¸ Installation & Setup

### 1. Clone the Repository

```sh
git clone https://github.com/jaychavada01/Assignment-5-Backend.git
cd api
```

### 2. Install Dependencies

```sh
npm install
```

### 3. Configure Environment Variables

Create a `.env` file in the `api/` directory and add the following values:

```
PORT=3000
JWT_SECRET=your_jwt_secret
DB_NAME=your_db_name
DB_USER=your_user
DB_PASSWORD=your_pass
DB_HOST=localhost
DB_DIALECT=postgres
MAILTRAP_HOST=smtp.mailtrap.io
MAILTRAP_PORT=2525
MAILTRAP_USER=your_mailtrap_username
MAILTRAP_PASS=your_mailtrap_password
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=your_aws_region
S3_BUCKET_NAME=your_s3_bucket_name
SQS_QUEUE_URL=your_sqs_queue_url
STRIPE_SECRET_KEY=your_key
```

---

## ğŸ› ï¸ Features

âœ… **User Authentication** (Signup/Login/Logout)  
âœ… **JWT-based Authorization**  
âœ… **Referral System** (Users refer others and earn rewards)  
âœ… **Daily Login Rewards** (Users earn 10 coins for logging in daily)  
âœ… **Profile Completion Rewards** (Users get 30 coins for 100% completion)  
âœ… **Activity Tracking** (Logs user activities like login, referrals, profile updates)  
âœ… **Achievements System** (Users unlock rewards based on activities)  
âœ… **Forgot Password & Reset Password** (Secure password recovery)  
âœ… **AWS S3 Integration** (File uploads & storage)  
âœ… **AWS SQS Integration** (Message queuing for notifications & tasks)  
âœ… **Stripe Payment Integration** (Card management & transactions)  
âœ… **Multilingual Support** (English, Hindi, French, German)
âœ… **API Documentation** (Swagger integration)

---

### **Multilingual Support**

- The application supports multiple languages: **English (default), Hindi, French, and German**.
- Language preference is detected from the request headers or query parameters (`?lang=fr`).
- Translations are stored in the `/locales/` directory.
- Example usage in API response:
  ```js
  res.t("auth.signup_success"); // Retrieves translated message based on user's language preference
  ```

---

## ğŸ”— API Endpoints

### **Authentication**

| Method | Endpoint                 | Description                                                              | Auth Required |
| ------ | ------------------------ | ------------------------------------------------------------------------ | ------------- |
| POST   | `/users/signup`          | Register a new user. If a referral code is used, both users get rewards. | âŒ No         |
| POST   | `/users/login`           | Log in and get JWT token. Tracks daily login rewards.                    | âŒ No         |
| POST   | `/users/logout`          | Log out and blacklist token.                                             | âœ… Yes        |
| POST   | `/users/reset-password`  | Reset password.                                                          | âŒ No         |
| POST   | `/users/forgot-password` | Send password reset email.                                               | âŒ No         |
| POST   | `/users/change-password` | Change password.                                                         | âœ… Yes        |

### **AWS Integrations**

| Method | Endpoint              | Description                     | Auth Required |
| ------ | --------------------- | ------------------------------- | ------------- |
| POST   | `/users/upload-aws`   | Upload files to AWS S3          | âœ… Yes        |
| POST   | `/users/send-message` | Send a message to AWS SQS queue | âœ… Yes        |

### **Payment Processing**

| Method | Endpoint                | Description                      | Auth Required |
| ------ | ----------------------- | -------------------------------- | ------------- |
| POST   | `/payment/add-card`     | Add a new payment card           | âœ… Yes        |
| GET    | `/payment/cards`        | List all saved payment cards     | âœ… Yes        |
| POST   | `/payment/transaction`  | Process a payment transaction    | âœ… Yes        |

---

## ğŸš€ How It Works

### 1. **User Authentication & Referral**

- New users register and receive a unique **referral code**.
- If a user signs up using a referral code, both referrer and referred user get **50 coins**.

### 2. **Multilingual Support**

- Users can receive API responses in **English, Hindi, French, or German**.
- The system detects language preference from request headers or query parameters (`?lang=fr`).

### 3. **Daily Login Rewards**

- Users receive **10 coins** every day they log in.
- Activity logs are stored in the **Activity table**.

### 4. **AWS S3 & SQS Integration**

- Users can upload files to **AWS S3** for secure storage.
- Messages for events (e.g., notifications) are sent to **AWS SQS** for asynchronous processing.
- The SQS worker process handles background tasks and notifications.

### 5. **Stripe Payment Integration**

- Users can add payment cards and make transactions securely.
- Card details are stored using Stripe's token system for PCI compliance.

---

## âœ¨ Technologies Used

- **Node.js** & **Express.js** â€“ Backend Framework
- **Sequelize** â€“ ORM for PostgreSQL
- **JWT (JSON Web Token)** â€“ Authentication
- **Bcrypt.js** â€“ Password Hashing
- **Nodemailer & Mailtrap** â€“ Email Notifications
- **AWS S3** â€“ File Storage
- **AWS SQS** â€“ Message Queue Service
- **Stripe** â€“ Payment Processing
- **i18n** â€“ Multilingual Support
- **Swagger** â€“ API Documentation
- **Firebase** â€“ Notifications (Optional)